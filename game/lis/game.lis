1 GELLOAD "line","lineg.png"
2 GELLOAD "fon","fon.png"
3 WSCREEN=SCREENWIDTH(0):HSCREEN=SCREENHEIGHT(0)
4 GELLOAD "lght","lght.png": GELLOAD "gora","gora.png": GELLOAD "moon","moon.png"
5 GELGRAB "zero",0,0,1,1: COLORALPHAGEL "zero",0,255,255,255
6 GELLOAD "many","many.png": GELLOAD "uhr","uhr.png": GELLOAD "polosa-bok","polosa-bok.png": GELLOAD "polosa-end","polosa-end.png"
7 GELLOAD "left-bok","left-bok.png": GELLOAD "right-bok","right-bok.png"
8 SETCOLOR 0,0,0: GELGRAB "level-end-l",0,0,WSCREEN,0.533*HSCREEN: ALPHAGEL "level-end-l",63
9 GELGRAB "level-pause",0,0,WSCREEN,HSCREEN: ALPHAGEL "level-pause",127: GELLOAD "level-end","level-end.png": GELLOAD "level-trap","level-trap.png"
10 GELLOAD "exit-icon","exit-icon.png": GELLOAD "menu-key","menu-key.png": GELLOAD "pause-key","pause-key.png": GELLOAD "pause-icon","pause-icon.png"
11 GELLOAD "akt-name","akt1-name.png": GELLOAD "to-menu","to-menu.png": GELLOAD "sel-to-menu","sel-to-menu.png"
12 N%=32
13 DIM XDN(N%)
14 DIM XDK(N%)
15 DIM ZDN(N%)
16 DIM ZDK(N%)
17 XDN(0)=-550:ZDN(0)=2150
18 XDK(0)=150:ZDK(0)=2100
19 XDN(1)=100:ZDN(1)=2100
20 XDK(1)=150:ZDK(1)=2050
21 XDN(2)=100:ZDN(2)=1950
22 XDK(2)=400:ZDK(2)=1900
23 XDN(3)=100:ZDN(3)=1900
24 XDK(3)=150:ZDK(3)=1800
25 XDN(4)=350:ZDN(4)=1900
26 XDK(4)=400:ZDK(4)=1800
27 XDN(5)=100:ZDN(5)=1800
28 XDK(5)=400:ZDK(5)=1750
29 XDN(6)=350:ZDN(6)=1650
30 XDK(6)=400:ZDK(6)=1600
31 XDN(7)=350:ZDN(7)=1600
32 XDK(7)=800:ZDK(7)=1550
33 XDN(8)=550:ZDN(8)=1450
34 XDK(8)=600:ZDK(8)=1350
35 XDN(9)=700:ZDN(9)=1400
36 XDK(9)=800:ZDK(9)=1350
37 XDN(10)=750:ZDN(10)=1350
38 XDK(10)=800:ZDK(10)=1300
39 XDN(11)=750:ZDN(11)=1200
40 XDK(11)=800:ZDK(11)=1100
41 XDN(12)=900:ZDN(12)=1200
42 XDK(12)=950:ZDK(12)=1100
43 XDN(13)=700:ZDN(13)=1100
44 XDK(13)=950:ZDK(13)=1050
45 XDN(14)=350:ZDN(14)=1100
46 XDK(14)=600:ZDK(14)=1050
47 XDN(15)=350:ZDN(15)=1050
48 XDK(15)=400:ZDK(15)=1000
49 XDN(16)=100:ZDN(16)=1100
50 XDK(16)=250:ZDK(16)=1050
51 XDN(17)=100:ZDN(17)=1050
52 XDK(17)=150:ZDK(17)=950
53 XDN(18)=200:ZDN(18)=1050
54 XDK(18)=250:ZDK(18)=950
55 XDN(19)=100:ZDN(19)=950
56 XDK(19)=250:ZDK(19)=900
57 XDN(20)=100:ZDN(20)=800
58 XDK(20)=150:ZDK(20)=750
59 XDN(21)=250:ZDN(21)=800
60 XDK(21)=350:ZDK(21)=750
61 XDN(22)=300:ZDN(22)=750
62 XDK(22)=350:ZDK(22)=700
63 XDN(23)=300:ZDN(23)=600
64 XDK(23)=350:ZDK(23)=500
65 XDN(24)=250:ZDN(24)=500
66 XDK(24)=350:ZDK(24)=450
67 XDN(25)=-150:ZDN(25)=500
68 XDK(25)=150:ZDK(25)=450
69 XDN(26)=-150:ZDN(26)=450
70 XDK(26)=-100:ZDK(26)=350
71 XDN(27)=0:ZDN(27)=450
72 XDK(27)=50:ZDK(27)=350
73 XDN(28)=-150:ZDN(28)=350
74 XDK(28)=50:ZDK(28)=300
75 XDN(29)=-150:ZDN(29)=200
76 XDK(29)=-100:ZDK(29)=150
77 XDN(30)=-150:ZDN(30)=150
78 XDK(30)=50:ZDK(30)=100
79 XDN(31)=0:ZDN(31)=100
80 XDK(31)=50:ZDK(31)=0
81 X_PN%=-400:Z_PN%=2162
82 X_PK%=-395:Z_PK%=2162
83 X_FN%=-395:Z_FN%=2162
84 X_FK%=-345:Z_FK%=2162
85 X_Q1N%=-395:Z_Q1N%=2162
86 X_Q1K%=-379:Z_Q1K%=2162
87 X_Q2N%=-378:Z_Q2N%=2162
88 X_Q2K%=-362:Z_Q2K%=2162
89 X_Q3N%=-361:Z_Q3N%=2162
90 YMIN=-110
91 QUALITET=HSCREEN*24/700: IF QUALITET>24 THEN QUALITET=24
94 YMAX=-80
95 ZKO=450
96 ZLO=200
97 PROP=15
98 SUJ=0.05:ZDREAM%=30
99 XPERS%=0:ZPERS%=62:YPERS%=-80
100 NN%=3:KK%=2: IF GAME_GAME=1 THEN  GOTO 111
101 WTW=SCREENWIDTH(0)
109 NC%=50
110 DIM XDNC(NC%): DIM ZDNC(NC%): DIM XDKC(NC%): DIM ZDKC(NC%): DIM STATUS_C%(NC%): DIM NAM_CO$(NC%): DIM ANI_COLCO%(NC%): DIM ZNAK_C%(NC%): DIM COLCO%(NC%)
111 FOR T%=0 TO NC%-1
112 ZNAK_C%(T%)=1:ANI_COLCO%(T%)=6
113 NEXT T%
115 XDNC(49)=-37:ZDNC(49)=130
120 XDKC(49)=-14:ZDKC(49)=121
125 XDNC(48)=-87:ZDNC(48)=130
130 XDKC(48)=-64:ZDKC(48)=121
135 XDNC(47)=-137:ZDNC(47)=130
140 XDKC(47)=-114:ZDKC(47)=121
145 XDNC(46)=13:ZDNC(46)=330
150 XDKC(46)=36:ZDKC(46)=321
155 XDNC(45)=-37:ZDNC(45)=330
160 XDKC(45)=-14:ZDKC(45)=321
165 XDNC(44)=-87:ZDNC(44)=330
170 XDKC(44)=-64:ZDKC(44)=321
175 XDNC(43)=-137:ZDNC(43)=330
180 XDKC(43)=-114:ZDKC(43)=321
205 XDNC(42)=13:ZDNC(42)=480
210 XDKC(42)=36:ZDKC(42)=471
215 XDNC(41)=-37:ZDNC(41)=480
220 XDKC(41)=-14:ZDKC(41)=471
225 XDNC(40)=-87:ZDNC(40)=480
230 XDKC(40)=-64:ZDKC(40)=471
235 XDNC(39)=-137:ZDNC(39)=480
240 XDKC(39)=-114:ZDKC(39)=471
241 XDNC(38)=313:ZDNC(38)=780
242 XDKC(38)=336:ZDKC(38)=771
245 XDNC(37)=213:ZDNC(37)=930
250 XDKC(37)=236:ZDKC(37)=921
255 XDNC(36)=163:ZDNC(36)=930
260 XDKC(36)=186:ZDKC(36)=921
265 XDNC(35)=113:ZDNC(35)=930
270 XDKC(35)=136:ZDKC(35)=921
315 XDNC(34)=213:ZDNC(34)=1080
320 XDKC(34)=236:ZDKC(34)=1071
325 XDNC(33)=163:ZDNC(33)=1080
330 XDKC(33)=186:ZDKC(33)=1071
335 XDNC(32)=113:ZDNC(32)=1080
340 XDKC(32)=136:ZDKC(32)=1071
345 XDNC(31)=413:ZDNC(31)=1080
350 XDKC(31)=436:ZDKC(31)=1071
355 XDNC(30)=463:ZDNC(30)=1080
360 XDKC(30)=486:ZDKC(30)=1071
365 XDNC(29)=513:ZDNC(29)=1080
370 XDKC(29)=536:ZDKC(29)=1071
375 XDNC(28)=813:ZDNC(28)=1080
380 XDKC(28)=836:ZDKC(28)=1071
385 XDNC(27)=863:ZDNC(27)=1080
390 XDKC(27)=886:ZDKC(27)=1071
395 XDNC(26)=913:ZDNC(26)=1080
400 XDKC(26)=936:ZDKC(26)=1071
415 XDNC(25)=913:ZDNC(25)=1180
420 XDKC(25)=936:ZDKC(25)=1171
421 XDNC(24)=763:ZDNC(24)=1380
422 XDKC(24)=786:ZDKC(24)=1371
425 XDNC(23)=563:ZDNC(23)=1580
430 XDKC(23)=586:ZDKC(23)=1571
435 XDNC(22)=613:ZDNC(22)=1580
440 XDKC(22)=636:ZDKC(22)=1571
445 XDNC(21)=663:ZDNC(21)=1580
450 XDKC(21)=686:ZDKC(21)=1571
455 XDNC(20)=713:ZDNC(20)=1580
460 XDKC(20)=736:ZDKC(20)=1571
465 XDNC(19)=763:ZDNC(19)=1580
470 XDKC(19)=786:ZDKC(19)=1571
475 XDNC(18)=113:ZDNC(18)=1780
480 XDKC(18)=136:ZDKC(18)=1771
485 XDNC(17)=163:ZDNC(17)=1780
490 XDKC(17)=186:ZDKC(17)=1771
495 XDNC(16)=213:ZDNC(16)=1780
500 XDKC(16)=236:ZDKC(16)=1771
505 XDNC(15)=263:ZDNC(15)=1780
510 XDKC(15)=286:ZDKC(15)=1771
515 XDNC(14)=313:ZDNC(14)=1780
520 XDKC(14)=336:ZDKC(14)=1771
525 XDNC(13)=363:ZDNC(13)=1780
530 XDKC(13)=386:ZDKC(13)=1771
535 XDNC(12)=113:ZDNC(12)=1930
545 XDKC(12)=136:ZDKC(12)=1921
550 XDNC(11)=163:ZDNC(11)=1930
555 XDKC(11)=186:ZDKC(11)=1921
560 XDNC(10)=213:ZDNC(10)=1930
565 XDKC(10)=236:ZDKC(10)=1921
570 XDNC(9)=263:ZDNC(9)=1930
575 XDKC(9)=286:ZDKC(9)=1921
580 XDNC(8)=313:ZDNC(8)=1930
585 XDKC(8)=336:ZDKC(8)=1921
590 XDNC(7)=363:ZDNC(7)=1930
595 XDKC(7)=386:ZDKC(7)=1921
600 XDNC(6)=13:ZDNC(6)=2130
605 XDKC(6)=36:ZDKC(6)=2121
610 XDNC(5)=-37:ZDNC(5)=2130
615 XDKC(5)=-14:ZDKC(5)=2121
620 XDNC(4)=-87:ZDNC(4)=2130
625 XDKC(4)=-64:ZDKC(4)=2121
630 XDNC(3)=-137:ZDNC(3)=2130
635 XDKC(3)=-114:ZDKC(3)=2121
640 XDNC(2)=-187:ZDNC(2)=2130
645 XDKC(2)=-164:ZDKC(2)=2121
650 XDNC(1)=-237:ZDNC(1)=2130
655 XDKC(1)=-214:ZDKC(1)=2121
660 XDNC(0)=-287:ZDNC(0)=2130
665 XDKC(0)=-264:ZDKC(0)=2121
666 COLCO_ALL=50
667 IF GAME_GAME=1 THEN  GOTO 725
670 GELLOAD "c-b1","c-b1.png": GELLOAD "c-b2","c-b2.png": GELLOAD "c-b3","c-b3.png": GELLOAD "c-b4","c-b4.png"
671 GELLOAD "c-b5","c-b5.png": GELLOAD "c-b6","c-b6.png"
725 YMAXC=-45
730 YMINC=-68
731 RING_STAT=1
732 ZLOC=99:ZKOC=200: IF GAME_GAME=1 THEN  GOTO 735
733 N_INFO%=37
734 DIM XIN(N_INFO%): DIM ZIN(N_INFO%): DIM YI_MIN(N_INFO%): DIM XIK(N_INFO%): DIM ZIK(N_INFO%): DIM YI_MAX(N_INFO%):QUALITET_INFO=1:ZUMY_I=0.3:ZUMX_I=0.3:ZLO_I=2000:ZKO_I=2100:ETAP=0
735 XIN(0)=0:ZIN(0)=5990:YI_MIN(0)=250
736 XIK(0)=1050:ZIK(0)=6010:YI_MAX(0)=-50
737 XIN(1)=50:ZIN(1)=6000:YI_MIN(1)=200
738 XIK(1)=100:ZIK(1)=6010:YI_MAX(1)=0
739 XIN(2)=100:ZIN(2)=6000:YI_MIN(2)=200
740 XIK(2)=200:ZIK(2)=6010:YI_MAX(2)=150
741 XIN(3)=100:ZIN(3)=6000:YI_MIN(3)=50
742 XIK(3)=200:ZIK(3)=6010:YI_MAX(3)=0
743 XIN(4)=250:ZIN(4)=6000:YI_MIN(4)=200
744 XIK(4)=400:ZIK(4)=6010:YI_MAX(4)=150
745 XIN(5)=300:ZIN(5)=6000:YI_MIN(5)=150
746 XIK(5)=350:ZIK(5)=6010:YI_MAX(5)=0
747 XIN(6)=450:ZIN(6)=6000:YI_MIN(6)=150
748 XIK(6)=500:ZIK(6)=6010:YI_MAX(6)=0
749 XIN(7)=500:ZIN(7)=6000:YI_MIN(7)=200
750 XIK(7)=550:ZIK(7)=6010:YI_MAX(7)=150
751 XIN(8)=500:ZIN(8)=6000:YI_MIN(8)=100
752 XIK(8)=550:ZIK(8)=6010:YI_MAX(8)=50
753 XIN(9)=550:ZIN(9)=6000:YI_MIN(9)=150
754 XIK(9)=600:ZIK(9)=6010:YI_MAX(9)=0
755 XIN(10)=650:ZIN(10)=6000:YI_MIN(10)=200
756 XIK(10)=700:ZIK(10)=6010:YI_MAX(10)=0
757 XIN(11)=700:ZIN(11)=6000:YI_MIN(11)=200
758 XIK(11)=750:ZIK(11)=6010:YI_MAX(11)=150
759 XIN(12)=700:ZIN(12)=6000:YI_MIN(12)=100
760 XIK(12)=750:ZIK(12)=6010:YI_MAX(12)=50
761 XIN(13)=750:ZIN(13)=6000:YI_MIN(13)=200
762 XIK(13)=800:ZIK(13)=6010:YI_MAX(13)=50
763 XIN(14)=850:ZIN(14)=6000:YI_MIN(14)=200
764 XIK(14)=1000:ZIK(14)=6010:YI_MAX(14)=150
765 XIN(15)=900:ZIN(15)=6000:YI_MIN(15)=150
766 XIK(15)=950:ZIK(15)=6010:YI_MAX(15)=0
767 XIN(16)=-350:ZIN(16)=3990:YI_MIN(16)=250
768 XIK(16)=700:ZIK(16)=4000:YI_MAX(16)=-50
769 XIN(17)=50:ZIN(17)=4000:YI_MIN(17)=200
770 XIK(17)=100:ZIK(17)=4010:YI_MAX(17)=80
771 XIN(18)=150:ZIN(18)=4000:YI_MIN(18)=200
772 XIK(18)=200:ZIK(18)=4010:YI_MAX(18)=80
773 XIN(19)=250:ZIN(19)=4000:YI_MIN(19)=200
774 XIK(19)=300:ZIK(19)=4010:YI_MAX(19)=80
775 XIN(20)=50:ZIN(20)=4000:YI_MIN(20)=50
776 XIK(20)=100:ZIK(20)=4010:YI_MAX(20)=0
777 XIN(21)=150:ZIN(21)=4000:YI_MIN(21)=50
778 XIK(21)=200:ZIK(21)=4010:YI_MAX(21)=0
779 XIN(22)=250:ZIN(22)=4000:YI_MIN(22)=50
780 XIK(22)=300:ZIK(22)=4010:YI_MAX(22)=0
781 XIN(23)=-100:ZIN(23)=1990:YI_MIN(23)=250
782 XIK(23)=950:ZIK(23)=2000:YI_MAX(23)=-50
783 XIN(24)=50:ZIN(24)=2000:YI_MIN(24)=150
784 XIK(24)=100:ZIK(24)=2010:YI_MAX(24)=0
785 XIN(25)=100:ZIN(25)=2000:YI_MIN(25)=200
786 XIK(25)=150:ZIK(25)=2010:YI_MAX(25)=150
787 XIN(26)=100:ZIN(26)=2000:YI_MIN(26)=100
788 XIK(26)=150:ZIK(26)=2010:YI_MAX(26)=50
789 XIN(27)=150:ZIN(27)=2000:YI_MIN(27)=150
790 XIK(27)=200:ZIK(27)=2010:YI_MAX(27)=0
791 XIN(28)=250:ZIN(28)=2000:YI_MIN(28)=200
792 XIK(28)=300:ZIK(28)=2010:YI_MAX(28)=0
793 XIN(29)=300:ZIN(29)=2000:YI_MIN(29)=150
794 XIK(29)=350:ZIK(29)=2010:YI_MAX(29)=100
795 XIN(30)=350:ZIN(30)=2000:YI_MIN(30)=200
796 XIK(30)=400:ZIK(30)=2010:YI_MAX(30)=150
797 XIN(31)=350:ZIN(31)=2000:YI_MIN(31)=100
798 XIK(31)=400:ZIK(31)=2010:YI_MAX(31)=50
799 XIN(32)=400:ZIN(32)=2000:YI_MIN(32)=50
800 XIK(32)=450:ZIK(32)=2010:YI_MAX(32)=0
801 XIN(33)=450:ZIN(33)=2000:YI_MIN(33)=200
802 XIK(33)=600:ZIK(33)=2010:YI_MAX(33)=150
803 XIN(34)=500:ZIN(34)=2000:YI_MIN(34)=150
804 XIK(34)=550:ZIK(34)=2010:YI_MAX(34)=0
805 XIN(35)=700:ZIN(35)=2000:YI_MIN(35)=150
806 XIK(35)=750:ZIK(35)=2010:YI_MAX(35)=100
807 XIN(36)=750:ZIN(36)=2000:YI_MIN(36)=200
808 XIK(36)=800:ZIK(36)=2010:YI_MAX(36)=0
809 FOR T%=16 TO 22
810 XIN(T%)=XIN(T%)-175:XIK(T%)=XIK(T%)-175:YI_MIN(T%)=YI_MIN(T%)-100:YI_MAX(T%)=YI_MAX(T%)-100
811 NEXT T%
812 FOR T%=0 TO 15
813 XIN(T%)=XIN(T%)-525:XIK(T%)=XIK(T%)-525:YI_MIN(T%)=YI_MIN(T%)-100:YI_MAX(T%)=YI_MAX(T%)-100
814 NEXT T%
815 FOR T%=23 TO 36
816 XIN(T%)=XIN(T%)-425:XIK(T%)=XIK(T%)-425:YI_MIN(T%)=YI_MIN(T%)-100:YI_MAX(T%)=YI_MAX(T%)-100
817 NEXT T%
818 IF GAME_GAME=1 THEN  GOTO 900
820 FOR T%=1 TO 14
821 NAME1$="son-up"+STR$(T%):NAME11$=NAME1$+".png"
822 NAME2$="L-son"+STR$(T%):NAME22$=NAME2$+".png"
823 NAME3$="R-son"+STR$(T%):NAME33$=NAME3$+".png"
824 GELLOAD NAME1$,NAME11$: GELLOAD NAME2$,NAME22$: GELLOAD NAME3$,NAME33$
825 NEXT T%
830 FOR T%=1 TO 16
835 NAME1$="down-son"+STR$(T%):NAME11$=NAME1$+".png"
840 GELLOAD NAME1$,NAME11$
845 NEXT T%
850 FOR T%=1 TO 4
855 NAME1$="prg-son"+STR$(T%):NAME11$=NAME1$+".png"
860 NAME2$="L-prg-son"+STR$(T%):NAME22$=NAME2$+".png"
865 NAME3$="R-prg-son"+STR$(T%):NAME33$=NAME3$+".png"
870 GELLOAD NAME1$,NAME11$: GELLOAD NAME2$,NAME22$: GELLOAD NAME3$,NAME33$
875 NEXT T%
880 GELLOAD "l-son","l-son.png": GELLOAD "r-son","r-son.png": GELLOAD "u-son","u-son.png": GELLOAD "d-son","d-son.png"
885 RT_S%=1:LF_S%=1:DW_S%=1:UP_S%=1
890 NAM_SON$="u-son"
891 GELLOAD "sneg","sneg.png"
900 FOR T%=0 TO N%-1
901 XDN(T%)=XDN(T%)-25:XDK(T%)=XDK(T%)-25
903 NEXT T%
904 FOR T%=0 TO NC%-1
905 XDNC(T%)=XDNC(T%)-25:XDKC(T%)=XDKC(T%)-25
906 NEXT T%
907 PRIGOK=0
919 WSCREEN=SCREENWIDTH(0):HSCREEN=SCREENHEIGHT(0):WH=HSCREEN: IF WSCREEN>HSCREEN THEN WH=WSCREEN
920 LMX%=WH/30+5
921 FONW%=WSCREEN/64: IF 64*FONW%<WSCREEN THEN FONW%=FONW%+1
922 FONH%=HSCREEN/64: IF 64*FONH%<(HSCREEN) THEN FONH%=FONH%+1
923 FOR T1%=0 TO FONH%-1
924 FOR T2%=0 TO FONW%-1
925 DRAWGEL "fon",64*T2%,LMX%+64*T1%
926 NEXT T2%
927 NEXT T1%
928 GELGRAB "1-fon",0,0,WSCREEN,((0.4*HSCREEN-LMX%)/3)-1
929 GELGRAB "2-fon",0,((0.4*HSCREEN-LMX%)/3)-1+0.533*HSCREEN,WSCREEN,HSCREEN-((0.4*HSCREEN-LMX%)/3)-1-0.533*HSCREEN
930 U_PRG%=1:D_PRG%=4:L_PRG%=1:R_PRG%=1:UPING=1
931 IF GAME_GAME=1 THEN  GOTO 964
940 SNEGW%=WSCREEN/62: IF SNEGW%*62<WSCREEN THEN SNEGW%=SNEGW%+1
941 SNEGH%=0.505*HSCREEN/62: IF SNEGH%*62<0.505*HSCREEN THEN SNEGH%=SNEGH%+1
942 SHOW%=SNEGW%*SNEGH%
943 DIM V_SNEG(SHOW%): DIM X_SNEG%(SHOW%): DIM Y_SNEG%(SHOW%): DIM ALF_SNEG(SHOW%): DIM RAD_SNEG%(SHOW%)
944 FOR T1%=0 TO SNEGH%-1
945 FOR T2%=0 TO SNEGW%-1
946 ALF_SNEG(SNEGW%*(T1%)+T2%)= RAND(0,89)
947 V_SNEG(SNEGW%*(T1%)+T2%)= RAND(1,10)
948 RAD_SNEG%(SNEGW%*(T1%)+T2%)= RAND(1,16)
949 Y_SNEG%(SNEGW%*(T1%)+T2%)=0.115*HSCREEN+T1%*62
950 NEXT T2%
951 NEXT T1%
958 FOR POR%=0 TO 9
959 FOR T%=1 TO 8
960 NAMA$="ok-"+STR$(POR%)+STR$(T%):NAMA_F$=NAMA$+".jpg": GELLOAD NAMA$,NAMA_F$
961 NEXT T%
962 NEXT POR%
963 T1%=1:LEWELW%=WSCREEN/240: IF LEWELW%*240<WSCREEN THEN LEWELW%=LEWELW%+1
964 IF T1%=1 THEN OK_C%=8
965 IF T1%=2 THEN OK_C%=16
966 IF T1%=3 THEN OK_C%=24
967 IF T1%=4 THEN OK_C%=32
968 IF T1%=5 THEN OK_C%=48
969 IF T1%=6 THEN OK_C%=64
970 IF T1%=7 THEN OK_C%=96
971 IF T1%>=8 THEN OK_C%=128
972 SUM_OC=SUM_OC+OK_C%
973 IF 0.505*0.618*HSCREEN>=SUM_OC THEN LEWELH%=T1%: GOTO 975
974 GOTO 976
975 T1%=T1%+1: GOTO 964
976 OCEAN%=((0.4*HSCREEN-LMX%)/3)-1+0.382*0.505*HSCREEN:LEWELH%=LEWELH%+1
977 TIME_GAME=2500:LEVEL_END%=0
980 FOR T%=0 TO NC%-1
981 STATUS_C%(T%)=0
982 NEXT T%
1000 WSCREEN=SCREENWIDTH(0):HSCREEN=SCREENHEIGHT(0):WH=HSCREEN: IF WSCREEN>HSCREEN THEN WH=WSCREEN
1001 LMX%=WH/30+5: IF WSCREEN<>WTW THEN  CLS 
1002 WOS=(WSCREEN/2)-1:ZUMX=2
1003 HOS=(2*HSCREEN-LMX%)/6-1:ZUMY=0.8*(1+(HSCREEN/1000))
1004 WTW=SCREENWIDTH(0):STOIT_NA_POLE%=0:TENI%=0
1005 SLEEP 23: SETCOLOR 0,19,127: FILLRECT 0,((0.4*HSCREEN-LMX%)/3)-1,WSCREEN,0.533*HSCREEN*0.4
1006 FOR T1%=0 TO LEWELH%-1
1007 IF T1%=0 THEN OK_Y%=0: GOTO 1016
1008 IF T1%=1 THEN OK_Y%=8: GOTO 1016
1009 IF T1%=2 THEN OK_Y%=OK_Y%+16: GOTO 1016
1010 IF T1%=3 THEN OK_Y%=OK_Y%+24: GOTO 1016
1011 IF T1%=4 THEN OK_Y%=OK_Y%+32: GOTO 1016
1012 IF T1%=5 THEN OK_Y%=OK_Y%+48: GOTO 1016
1013 IF T1%=6 THEN OK_Y%=OK_Y%+64: GOTO 1016
1014 IF T1%=7 THEN OK_Y%=OK_Y%+96: GOTO 1016
1015 IF T1%>=8 THEN OK_Y%=OK_Y%+128
1016 TT%=T1%+1: IF TT%>8 THEN TT%=8
1017 FOR T2%=0 TO LEWELW%-1
1018 NAME_OK$="ok-"+STR$(OK_ANIMA%)+STR$(TT%): DRAWGEL NAME_OK$,T2%*240,OCEAN%+OK_Y%
1019 NEXT T2%
1020 NEXT T1%
1021 IF  MILLISECONDS (0)-ICE_OK%>5 THEN OK_ANIMA%=OK_ANIMA%+1:ICE_OK%= MILLISECONDS (0)
1022 IF OK_ANIMA%>9 THEN OK_ANIMA%=0
1023 OSWEW%=WSCREEN/240: IF OSWEW%*240<WSCREEN THEN OSWEW%=OSWEW%+1
1024 FOR T%=0 TO OSWEW%-1
1025 DRAWGEL "lght",T%*240,OCEAN%
1026 NEXT T%
1027 DRAWGEL "moon",4+41,((0.4*HSCREEN-LMX%)/3)+16
1028 GORW%=WSCREEN/225: IF GORW%*225<WSCREEN THEN GORW%=GORW%+1
1029 FOR T%=0 TO GORW%-1
1030 DRAWGEL "gora",T%*225,OCEAN%-45
1031 NEXT T%
1032 IF ETAP<3 THEN  GOTO 1703
1040 FOR T%=0 TO N%-1
1049 IF XPERS%>=XDN(T%)+11 AND XPERS%<=XDK(T%)-11 AND ZPERS%<=ZDN(T%)-14 AND ZPERS%>=ZDK(T%)+10 AND YPERS%>=-80 THEN TENI%=1
1050 IF XPERS%>=XDN(T%) AND XPERS%<=XDK(T%) AND ZPERS%<=ZDN(T%) AND ZPERS%>=ZDK(T%) AND YPERS%=-80 THEN STOIT_NA_POLE%=1
1051 IF XPERS%>=XDN(T%) AND XPERS%<XDK(T%)-600 AND ZPERS%<=ZDN(T%) AND ZPERS%>ZDK(T%) AND YPERS%=-80 AND COLCO_SOBR=NC% AND SUM_TIME<TIME_GAME THEN LEVEL_END%=1
1052 IF XPERS%>=XDN(T%) AND XPERS%<=XDK(T%) AND ZPERS%<=ZDN(T%) AND ZPERS%>=ZDK(T%) THEN TOPN%=T%-NN%:TOPK%=T%+KK%:T%=N%-1
1060 NEXT T%
1070 IF TOPN%<0 THEN TOPN%=0
1080 IF TOPK%>N%-1 THEN TOPK%=N%-1
1081 X_PALKA=WOS+ZUMX*X_PN%*(PROP/(PROP+Z_PN%*SUJ)):Y_PALKA=HOS-ZUMY*(-30)*(PROP/(PROP+Z_PN%*SUJ))
1082 W_PALKA=ABS(X_PALKA-(WOS+ZUMX*X_PK%*(PROP/(PROP+Z_PK%*SUJ)))):H_PALKA=ABS(Y_PALKA-(HOS-ZUMY*(-90)*(PROP/(PROP+Z_PK%*SUJ))))
1083 X_FLAG=WOS+ZUMX*X_FN%*(PROP/(PROP+Z_FN%*SUJ)):Y_FLAG=HOS-ZUMY*(-30)*(PROP/(PROP+Z_FN%*SUJ))
1084 W_FLAG=ABS(X_FLAG-(WOS+ZUMX*X_FK%*(PROP/(PROP+Z_FK%*SUJ)))):H_FLAG=ABS(Y_FLAG-(HOS-ZUMY*(-60)*(PROP/(PROP+Z_FK%*SUJ))))
1085 X_Q1=WOS+ZUMX*X_Q1N%*(PROP/(PROP+Z_Q1N%*SUJ)):Y_Q1=HOS-ZUMY*(-30)*(PROP/(PROP+Z_Q1N%*SUJ))
1086 X_Q2=WOS+ZUMX*X_Q2N%*(PROP/(PROP+Z_Q2N%*SUJ)):Y_Q2=HOS-ZUMY*(-45)*(PROP/(PROP+Z_Q2N%*SUJ))
1089 X_Q3=WOS+ZUMX*X_Q3N%*(PROP/(PROP+Z_Q3N%*SUJ)):Y_Q3=HOS-ZUMY*(-30)*(PROP/(PROP+Z_Q3N%*SUJ))
1090 W_Q=ABS(X_Q1-(WOS+ZUMX*X_Q1K%*(PROP/(PROP+Z_Q1K%*SUJ)))):H_Q=ABS(Y_Q1-(HOS-ZUMY*(-45)*(PROP/(PROP+Z_Q1K%*SUJ))))
1091 SETCOLOR 255,0,0: FILLRECT X_PALKA,Y_PALKA,W_PALKA,H_PALKA
1092 SETCOLOR 255,255,255: FILLRECT X_FLAG,Y_FLAG,W_FLAG,H_FLAG
1093 SETCOLOR 128,128,128: FILLRECT X_Q1,Y_Q1,W_Q,H_Q: FILLRECT X_Q2,Y_Q2,W_Q,H_Q: FILLRECT X_Q3,Y_Q3,W_Q,H_Q
1110 FOR T%=TOPN% TO TOPK%
1120 IF ZDN(T%)<ZDREAM% AND ZDK(T%)<ZDREAM% THEN  GOTO 1390
1130 XL1=WOS+ZUMX*XDN(T%)*(PROP/(PROP+ZDN(T%)*SUJ)):YL1=HOS-ZUMY*YMAX*(PROP/(PROP+ZDN(T%)*SUJ))
1140 XL2=WOS+ZUMX*XDN(T%)*(PROP/(PROP+ZDK(T%)*SUJ)):YL2=HOS-ZUMY*YMAX*(PROP/(PROP+ZDK(T%)*SUJ))
1150 XR1=WOS+ZUMX*XDK(T%)*(PROP/(PROP+ZDN(T%)*SUJ)):YR1=HOS-ZUMY*YMIN*(PROP/(PROP+ZDN(T%)*SUJ))
1160 XR2=WOS+ZUMX*XDK(T%)*(PROP/(PROP+ZDK(T%)*SUJ)):YR2=HOS-ZUMY*YMIN*(PROP/(PROP+ZDK(T%)*SUJ))
1170 IF XL1<32 AND XL2<32 AND XR1<32 AND XR2<32 THEN  GOTO 1390
1180 IF XL1>WSCREEN-32 AND XL2>WSCREEN-32 AND XR1>WSCREEN-32 AND XR2>WSCREEN-32 THEN  GOTO 1390
1190 KFDELTA=((ZKO-((ZDN(T%)+ZDK(T%))/2))/ZKO):KF%=QUALITET*KFDELTA: IF KF%=0 THEN KF%=1
1200 IF KFDELTA>1 THEN KF%=QUALITET
1210 IF KFDELTA<0 THEN KF%=1
1220 DXL=(XL2-XL1)/KF%:DXR=(XR2-XR1)/KF%:DYL=(YL2-YL1)/KF%:DYR=(YR2-YR1)/KF%:LNO=1:LKO=1
1230 IF ZDN(T%)>ZLO THEN LNO=0.2
1240 IF ZDK(T%)>ZLO THEN LKO=0.2
1250 IF ZDN(T%)<=ZLO AND ZDN(T%)>=0 THEN LNO=(ZLO-ZDN(T%))/ZLO
1260 IF ZDK(T%)<=ZLO AND ZDK(T%)>=0 THEN LKO=(ZLO-ZDK(T%))/ZLO
1270 IF LNO<0.2 THEN LNO=0.2
1280 IF LKO<0.2 THEN LKO=0.2
1290 DZLO=(LKO-LNO)/KF%
1300 SETCOLOR 91*LNO,127*LNO,0: FILLROUNDRECT XL1,YL1,XR1-XL1,(YR1-YL1)*0.6,16,14
1310 SETCOLOR 127*LNO,51*LNO,0: FILLRECT XL1,YL1+(YR1-YL1)*0.6/2,XR1-XL1,(YR1-YL1)*0.8
1320 FOR A%=1 TO KF%-1
1330 XX=XL1+A%*DXL:YY=YL1+A%*DYL:XXX=XR1+A%*DXR:YYY=YR1+A%*DYR
1340 SETCOLOR 91*(LNO+DZLO*A%),127*(LNO+DZLO*A%),0: FILLROUNDRECT XX,YY,XXX-XX,(YYY-YY)*0.6,16,14
1350 SETCOLOR 127*(LNO+DZLO*A%),51*(LNO+DZLO*A%),0: FILLRECT XX,YY+(YYY-YY)*0.6/2,XXX-XX,(YYY-YY)*0.8
1360 NEXT A%
1370 SETCOLOR 91*LKO,127*LKO,0: FILLROUNDRECT XL2,YL2,XR2-XL2,(YR2-YL2)*0.6,16,14
1380 SETCOLOR 127*LKO,51*LKO,0: FILLRECT XL2,YL2+(YR2-YL2)*0.6/2,XR2-XL2,(YR2-YL2)*0.8
1390 NEXT T%
1391 NACH=1:KONZ=1
1392 FOR T%=0 TO NC%-1
1393 IF NACH=1 AND ZDNC(T%)<ZKOC THEN TOPNC%=T%:NACH=0
1394 IF XPERS%>XDNC(T%) AND XPERS%<=XDKC(T%) AND ZPERS%<ZDNC(T%)+20 AND ZPERS%>=ZDKC(T%)-20 AND YPERS%=-80 THEN STATUS_C%(T%)=-1
1395 IF NACH=0 AND T%<>TOPNC% AND ZDNC(T%)<ZPERS%-16 THEN TOPKC%=T%-1:T%=NC%-1:KONZ=0
1396 NEXT T%
1397 IF KONZ=1 THEN TOPKC%=NC%-1
1410 FOR T%=TOPNC% TO TOPKC%
1411 IF STATUS_C%(T%)=-1 THEN  GOTO 1413
1412 GOTO 1430
1413 IF  MILLISECONDS (0)-COLCO%(T%)>32 THEN ANI_COLCO%(T%)=ANI_COLCO%(T%)-ZNAK_C%(T%):COLCO%(T%)= MILLISECONDS (0)
1414 IF ANI_COLCO%(T%)<1 THEN ZNAK_C%(T%)=-1:ANI_COLCO%(T%)=1
1415 IF ANI_COLCO%(T%)>6 THEN NAM_CO$(T%)="zero": GOTO 1417
1416 NAM_CO$(T%)="c-b"+STR$(ANI_COLCO%(T%))
1417 DRAWGEL NAM_CO$(T%),WOS+ZUMX*XDNC(T%)*(PROP/(PROP+ZDNC(T%)*SUJ))-10,HOS-ZUMY*YMAXC*(PROP/(PROP+ZDNC(T%)*SUJ))-10: GOTO 1690
1430 XL1=WOS+ZUMX*XDNC(T%)*(PROP/(PROP+ZDNC(T%)*SUJ)):YL1=HOS-ZUMY*YMAXC*(PROP/(PROP+ZDNC(T%)*SUJ))
1440 XL2=WOS+ZUMX*XDNC(T%)*(PROP/(PROP+ZDKC(T%)*SUJ)):YL2=HOS-ZUMY*YMAXC*(PROP/(PROP+ZDKC(T%)*SUJ))
1450 XR1=WOS+ZUMX*XDKC(T%)*(PROP/(PROP+ZDNC(T%)*SUJ)):YR1=HOS-ZUMY*YMINC*(PROP/(PROP+ZDNC(T%)*SUJ))
1460 XR2=WOS+ZUMX*XDKC(T%)*(PROP/(PROP+ZDKC(T%)*SUJ)):YR2=HOS-ZUMY*YMINC*(PROP/(PROP+ZDKC(T%)*SUJ))
1470 IF XL1<32 AND XL2<32 AND XR1<32 AND XR2<32 THEN  GOTO 1690
1480 IF XL1>WSCREEN-32 AND XL2>WSCREEN-32 AND XR1>WSCREEN-32 AND XR2>WSCREEN-32 THEN  GOTO 1690
1490 KFDELTA=((ZKOC-((ZDNC(T%)+ZDKC(T%))/2))/ZKOC):KF%=QUALITET*KFDELTA: IF KF%=0 THEN KF%=1
1500 IF KFDELTA>1 THEN KF%=QUALITET
1510 IF KFDELTA<0 THEN KF%=1
1520 DXL=(XL2-XL1)/KF%:DXR=(XR2-XR1)/KF%:DYL=(YL2-YL1)/KF%:DYR=(YR2-YR1)/KF%:LNO=1:LKO=1
1530 IF ZDNC(T%)>ZLOC THEN LNO=0.2
1540 IF ZDKC(T%)>ZLOC THEN LKO=0.2
1550 IF ZDNC(T%)<=ZLOC AND ZDNC(T%)>=0 THEN LNO=(ZLOC-ZDNC(T%))/ZLOC
1560 IF ZDKC(T%)<=ZLOC AND ZDKC(T%)>=0 THEN LKO=(ZLOC-ZDKC(T%))/ZLOC
1570 IF LNO<0.2 THEN LNO=0.2
1580 IF LKO<0.2 THEN LKO=0.2
1590 DZLO=(LKO-LNO)/KF%
1591 IF RING_STAT=1 AND  MILLISECONDS (0)-RINGS%>333 THEN RRING%=206:GRING%=172:BRING%=0:RINGS%= MILLISECONDS (0):RING_STAT=2
1592 IF RING_STAT=2 AND  MILLISECONDS (0)-RINGS%>333 THEN RRING%=255:GRING%=216:BRING%=0:RINGS%= MILLISECONDS (0):RING_STAT=1
1600 SETCOLOR 255*LNO,106*LNO,0*LNO: FILLARC XL1,YL1,XR1-XL1,(YR1-YL1),0,360
1620 FOR A%=1 TO KF%-1
1630 XX=XL1+A%*DXL:YY=YL1+A%*DYL:XXX=XR1+A%*DXR:YYY=YR1+A%*DYR
1640 SETCOLOR 255*(LNO+DZLO*A%),106*(LNO+DZLO*A%),0*(LNO+DZLO*A%): FILLARC XX,YY,XXX-XX,(YYY-YY),0,360
1660 NEXT A%
1670 SETCOLOR 255*LKO,106*LKO,0*LKO: FILLARC XL2,YL2,XR2-XL2,(YR2-YL2),0,360
1680 SETCOLOR RRING%*LKO,GRING%*LKO,BRING%*LKO: FILLARC XL2+(XR2-XL2)/2-0.7*(XR2-XL2)/2,YL2+(YR2-YL2)/2-0.7*(YR2-YL2)/2,(XR2-XL2)*0.7,(YR2-YL2)*0.7,0,360
1690 NEXT T%
1691 XPP=WOS+ZUMX*XPERS%*(PROP/(PROP+ZPERS%*SUJ)):YPP=HOS-ZUMY*YPERS%*(PROP/(PROP+ZPERS%*SUJ))
1692 IF STOIT_NA_POLE%=0 AND PRIGOK=0 THEN YPERS%=YPERS%-5
1693 TENEK=0.62*ABS(YPERS%+80)/10
1694 IF TENI%=1 THEN  SETCOLOR 51,71,0: FILLARC XPP-18+TENEK,HOS-ZUMY*(-80)*(PROP/(PROP+ZPERS%*SUJ))-5+TENEK/2,(18-TENEK)*2,(5-TENEK/2)*2,0,360
1695 IF PRIGOK=1 THEN YPERS%=YPERS%+5
1696 IF YPERS%>=15 THEN PRIGOK=0
1702 IF ETAP>=3 THEN  DRAWGEL NAM_SON$,(WSCREEN-95)/2,YPP-84
1703 COLCO_SOBR=0
1704 FOR T%=0 TO NC%-1
1705 COLCO_SOBR=COLCO_SOBR+STATUS_C%(T%)
1706 NEXT T%
1707 COLCO_SOBR=ABS(COLCO_SOBR)
2110 FOR T%=0 TO N_INFO%-1
2120 IF ZIN(T%)<ZDREAM% AND ZIK(T%)<ZDREAM% THEN  GOTO 2390
2130 XL1=WOS+ZUMX_I*XIN(T%)*(PROP/(PROP+ZIN(T%)*SUJ)):YL1=HOS-ZUMY_I*YI_MIN(T%)*(PROP/(PROP+ZIN(T%)*SUJ))
2140 XL2=WOS+ZUMX_I*XIN(T%)*(PROP/(PROP+ZIK(T%)*SUJ)):YL2=HOS-ZUMY_I*YI_MIN(T%)*(PROP/(PROP+ZIK(T%)*SUJ))
2150 XR1=WOS+ZUMX_I*XIK(T%)*(PROP/(PROP+ZIN(T%)*SUJ)):YR1=HOS-ZUMY_I*YI_MAX(T%)*(PROP/(PROP+ZIN(T%)*SUJ))
2160 XR2=WOS+ZUMX_I*XIK(T%)*(PROP/(PROP+ZIK(T%)*SUJ)):YR2=HOS-ZUMY_I*YI_MAX(T%)*(PROP/(PROP+ZIK(T%)*SUJ))
2170 IF XL1<32 AND XL2<32 AND XR1<32 AND XR2<32 THEN  GOTO 2390
2180 IF XL1>WSCREEN-32 AND XL2>WSCREEN-32 AND XR1>WSCREEN-32 AND XR2>WSCREEN-32 THEN  GOTO 2390
2190 KFDELTA=((ZKO_I-((ZIN(T%)+ZIK(T%))/2))/ZKO_I):KF%=QUALITET_INFO*KFDELTA: IF KF%=0 THEN KF%=1
2200 IF KFDELTA>1 THEN KF%=QUALITET
2210 IF KFDELTA<0 THEN KF%=1
2220 DXL=(XL2-XL1)/KF%:DXR=(XR2-XR1)/KF%:DYL=(YL2-YL1)/KF%:DYR=(YR2-YR1)/KF%:LNO=1:LKO=1
2230 IF ZIN(T%)>ZLO_I THEN LNO=0.2
2240 IF ZIK(T%)>ZLO_I THEN LKO=0.2
2250 IF ZIN(T%)<=ZLO_I AND ZIN(T%)>=0 THEN LNO=(ZLO_I-ZIN(T%))/ZLO_I
2260 IF ZIK(T%)<=ZLO_I AND ZIK(T%)>=0 THEN LKO=(ZLO_I-ZIK(T%))/ZLO_I
2270 IF LNO<0.2 THEN LNO=0.2
2280 IF LKO<0.2 THEN LKO=0.2
2290 DZLO=(LKO-LNO)/KF%
2300 SETCOLOR 255*LNO,255*LNO,255*LNO: IF T%=0 OR T%=16 OR T%=23 THEN  SETCOLOR 48*LNO,168*LNO,255*LNO: FILLROUNDRECT XL1,YL1,XR1-XL1,(YR1-YL1),10,10: GOTO 2320
2301 FILLROUNDRECT XL1,YL1,XR1-XL1,(YR1-YL1),2,2
2320 FOR A%=1 TO KF%-1
2330 XX=XL1+A%*DXL:YY=YL1+A%*DYL:XXX=XR1+A%*DXR:YYY=YR1+A%*DYR
2340 SETCOLOR 255*(LNO+DZLO*A%),255*(LNO+DZLO*A%),255*(LNO+DZLO*A%): IF T%=0 OR T%=16 OR T%=23 THEN  SETCOLOR 48*(LNO+DZLO*A%),168*(LNO+DZLO*A%),255*(LNO+DZLO*A%): FILLROUNDRECT XX,YY,XXX-XX,(YYY-YY),10,10: GOTO 2360
2341 FILLROUNDRECT XX,YY,XXX-XX,(YYY-YY),2,2
2360 NEXT A%
2370 SETCOLOR 255*LKO,255*LKO,255*LKO: IF T%=0 OR T%=16 OR T%=23 THEN  SETCOLOR 48*LKO,168*LKO,255*LKO: FILLROUNDRECT XL2,YL2,XR2-XL2,(YR2-YL2),10,10: GOTO 2390
2371 FILLROUNDRECT XL2,YL2,XR2-XL2,(YR2-YL2),2,2
2390 NEXT T%
2391 IF ETAP=0 AND ZIN(23)<256 THEN  SLEEP 1000:ETAP=1
2392 IF ETAP=1 AND ZIN(16)<256 THEN  SLEEP 1000:ETAP=2
2393 IF ETAP=2 AND ZIN(0)<256 THEN  SLEEP 1000:ETAP=3
2394 FOR T%=0 TO N_INFO%-1
2395 ZIN(T%)=ZIN(T%)-45:ZIK(T%)=ZIK(T%)-45
2396 NEXT T%
2409 DEG 
2410 FOR T1%=0 TO SNEGH%-1
2411 FOR T2%=0 TO SNEGW%-1
2412 IF  MILLISECONDS (0)-SNEG_G%>7 THEN ALF_SNEG(SNEGW%*(T1%)+T2%)=ALF_SNEG(SNEGW%*(T1%)+T2%)+1:SNE_G%= MILLISECONDS (0)
2413 Y_SNEG%(SNEGW%*(T1%)+T2%)=Y_SNEG%(SNEGW%*(T1%)+T2%)+V_SNEG(SNEGW%*(T1%)+T2%)
2414 X_SNEG%(SNEGW%*(T1%)+T2%)=T2%*62+RAD_SNEG%(SNEGW%*(T1%)+T2%)*COS(ALF_SNEG(SNEGW%*(T1%)+T2%))
2415 IF Y_SNEG%(SNEGW%*(T1%)+T2%)>0.618*HSCREEN THEN Y_SNEG%(SNEGW%*(T1%)+T2%)=0.115*HSCREEN
2416 DRAWGEL "sneg",X_SNEG%(SNEGW%*(T1%)+T2%),Y_SNEG%(SNEGW%*(T1%)+T2%)
2417 NEXT T2%
2418 NEXT T1%
2421 SETCOLOR 0,0,0: FILLRECT 0,(0.4*HSCREEN-LMX%)/3,32,0.533*HSCREEN: FILLRECT WSCREEN-32,(0.4*HSCREEN-LMX%)/3,32,0.533*HSCREEN
2422 REZ_UHR=1+(SUM_TIME/TIME_GAME)*(0.533*HSCREEN-64+15):REZ_MANY=1+(COLCO_SOBR/COLCO_ALL)*(0.533*HSCREEN-64+15)
2423 SETCOLOR 255,0,0: FILLRECT 0,(((0.4*HSCREEN-LMX%)/3)+48-7)+REZ_UHR,32,1+(1-SUM_TIME/TIME_GAME)*(0.533*HSCREEN-64+15)
2424 SETCOLOR 255,216,0: FILLRECT WSCREEN-32,((0.4*HSCREEN-LMX%)/3)-1+0.533*HSCREEN-8-REZ_MANY,32,REZ_MANY
2425 H_POLOSA%=(0.533*HSCREEN-64)/100: IF H_POLOSA%*100<(0.533*HSCREEN-64) THEN H_POLOSA%=H_POLOSA%+1
2426 FOR T%=0 TO H_POLOSA%-1
2427 DRAWGEL "polosa-bok",0,((0.4*HSCREEN-LMX%)/3)+48+T%*100: DRAWGEL "polosa-bok",WSCREEN-32,((0.4*HSCREEN-LMX%)/3)+48+T%*100
2428 NEXT T%
2429 DRAWGEL "uhr",0,((0.4*HSCREEN-LMX%)/3): DRAWGEL "many",WSCREEN-32,((0.4*HSCREEN-LMX%)/3)
2430 DRAWGEL "polosa-end",0,((0.4*HSCREEN-LMX%)/3)-1+0.533*HSCREEN-16: DRAWGEL "polosa-end",WSCREEN-32,((0.4*HSCREEN-LMX%)/3)-1+0.533*HSCREEN-16
2431 IF ETAP>=3 THEN SUM_TIME=SUM_TIME+1
2432 H_POLOSA2%=0.533*HSCREEN/48: IF H_POLOSA2%*48<0.533*HSCREEN THEN H_POLOSA2%=H_POLOSA2%+1
2433 FOR T%=0 TO H_POLOSA2%-1
2434 DRAWGEL "left-bok",32,((0.4*HSCREEN-LMX%)/3)+T%*48: DRAWGEL "right-bok",WSCREEN-39,((0.4*HSCREEN-LMX%)/3)+T%*48
2435 NEXT T%
2500 DRAWGEL "1-fon",0,0
2501 DRAWGEL "2-fon",0,((0.4*HSCREEN-LMX%)/3)-1+0.533*HSCREEN
2600 WGHG=(HSCREEN-2*LMX%)/3: IF (WSCREEN/2)<((HSCREEN-2*LMX%)/3) THEN WGHG=WSCREEN/2
2610 WG=(WGHG-32)/3.07:HG=0.707*WG:OKR=0.255*HG
2620 XGAM_UP=16+OKR+WG:YGAM_UP=16+LMX%+2*((HSCREEN-2*LMX%)/3)+OKR
2630 XGAM_RIGHT=16+OKR+WG+HG:YGAM_RIGHT=16+LMX%+2*((HSCREEN-2*LMX%)/3)+WG+OKR
2640 XGAM_DOWN=16+OKR+WG:YGAM_DOWN=16+OKR+LMX%+2*((HSCREEN-2*LMX%)/3)+WG+HG
2650 XGAM_LEFT=16+OKR:YGAM_LEFT=16+LMX%+2*((HSCREEN-2*LMX%)/3)+WG+OKR
2651 WGHGF=(HSCREEN-2*LMX%)/3: IF (WSCREEN/2)<((HSCREEN-2*LMX%)/3) THEN WGHGF=WSCREEN/2
2652 WGF=0.45*WGHGF:KOORF=0.55*WGHGF/2
2653 XFIRE_KEY=WSCREEN-1-16-WGF:YFIRE_KEY=LMX%+2*((HSCREEN-2*LMX%)/3)+KOORF
2666 LING%=WSCREEN/233: IF 233*LING%<WSCREEN THEN LING%=LING%+1
2667 FOR T%=0 TO LING%-1
2668 DRAWGEL "line",233*T%,(0.4*HSCREEN-LMX%)/3-10: DRAWGEL "line",233*T%,((0.4*HSCREEN-LMX%)/3)+0.533*HSCREEN-1
2669 NEXT T%
2670 SETCOLOR UR%,UG%,UB%: FILLRECT XGAM_UP,YGAM_UP,HG,WG: FILLARC XGAM_UP,YGAM_UP-OKR+1,HG,2*OKR,0,180
2680 SETCOLOR RR%,RG%,RB%: FILLRECT XGAM_RIGHT,YGAM_RIGHT,WG,HG: FILLARC XGAM_RIGHT+WG-OKR-1,YGAM_RIGHT,2*OKR,HG,270,180
2690 SETCOLOR DR%,DG%,DB%: FILLRECT XGAM_DOWN,YGAM_DOWN,HG,WG: FILLARC XGAM_DOWN,YGAM_DOWN+WG-OKR-1,HG,2*OKR,180,180
2700 SETCOLOR LR%,LG%,LB%: FILLRECT XGAM_LEFT,YGAM_LEFT,WG,HG: DEG : FILLARC XGAM_LEFT-OKR+1,YGAM_LEFT,2*OKR,HG,90,180
2701 SETCOLOR FR%,FG%,FB%: FILLROUNDRECT XFIRE_KEY,YFIRE_KEY,WGF,WGF,24,24
2710 DELCOL=127/LMX%
2720 FOR T%=0 TO LMX%-1
2730 SETCOLOR 0,38,128+T%*DELCOL: DRAWRECT 0,T%,WSCREEN,1: DRAWRECT 0,HSCREEN-1-(T%+1),WSCREEN,1
2740 NEXT T%
2741 DRAWGEL "exit-icon",WSCREEN-18,(LMX%-14)/2+1
2750 IF LEVEL_END%=1 THEN  DRAWGEL "level-end-l",0,((0.4*HSCREEN-LMX%)/3): DRAWGEL "level-end",(WSCREEN-162)/2,((0.4*HSCREEN-LMX%)/3)+(0.533*HSCREEN-72)/2
2751 IF YPERS%<-100 OR (TIME_GAME-SUM_TIME)<=2 THEN  DRAWGEL "level-end-l",0,((0.4*HSCREEN-LMX%)/3): DRAWGEL "level-trap",(WSCREEN-162)/2,((0.4*HSCREEN-LMX%)/3)+(0.533*HSCREEN-40)/2:SUM_TIME=TIME_GAME-1:P_WAIT=1: GOTO 2800
2752 RE_WAIT%= MILLISECONDS (0)
2760 DRAWGEL "akt-name",(WSCREEN-240)/2,1+(LMX%-12)/2
2761 DRAWGEL "menu-key",4,HSCREEN-LMX%+(LMX%-16)/2-1: DRAWGEL "pause-key",WSCREEN-66,HSCREEN-LMX%+(LMX%-16)/2-1
2762 IF PAUSE_GAME=1 THEN SUM_TIME=SUM_TIME-1: DRAWGEL "level-pause",0,0: DRAWGEL "pause-icon",(WSCREEN-96)/2,(HSCREEN-96)/2
2765 IF TO_MENU=1 THEN  DRAWGEL "level-pause",0,0: DRAWGEL "to-menu",(WSCREEN-162)/2,(HSCREEN-188)/2
2766 IF TO_MENU=1 AND  POINTX(0)>=(WSCREEN-162)/2 AND  POINTX(0)<(WSCREEN-162)/2+162 AND  POINTY(0)>=(HSCREEN-188)/2+76 AND  POINTY(0)<(HSCREEN-188)/2+121 THEN  DRAWGEL "sel-to-menu",(WSCREEN-162)/2,(HSCREEN-188)/2+76:SEL_MENU=1
2767 IF TO_MENU=1 AND  POINTX(0)>=(WSCREEN-162)/2 AND  POINTX(0)<(WSCREEN-162)/2+162 AND  POINTY(0)>=(HSCREEN-188)/2+123 AND  POINTY(0)<(HSCREEN-188)/2+180 THEN  DRAWGEL "sel-to-menu",(WSCREEN-162)/2,(HSCREEN-188)/2+123:SEL_MENU=2
2800 REPAINT:UR%=183:UG%=194:UB%=255:DR%=183:DG%=194:DB%=255:RR%=183:RG%=194:RB%=255:LR%=183:LG%=194:LB%=255:FR%=183:FG%=194:FB%=255
2801 IF LEVEL_END%=1 THEN  SLEEP 3142: CALL "/menu.bas"
2802 IF P_WAIT=1 AND  MILLISECONDS (0)-RE_WAIT%>3142 THEN GAME_GAME=1:ETAP=0:P_WAIT=0:YPERS%=-80:SUM_TIME=0: SLEEP 1111: GOTO 17
2803 IF P_WAIT=1 THEN  GOTO 1000
2804 IF PAUSE_GAME=1 AND  POINTX(0)>=(WSCREEN-96)/2 AND  POINTX(0)<(WSCREEN-96)/2+96 AND  POINTY(0)>=(HSCREEN-96)/2 AND  POINTY(0)<(HSCREEN-96)/2+96 THEN PAUSE_GAME=0
2805 IF PAUSE_GAME=1 THEN  GOTO 1000
2806 IF TO_MENU=1 AND SEL_MENU=1 THEN SEL_MENU=0:TO_MENU=0: SLEEP 666: CALL "/menu.bas"
2807 IF TO_MENU=1 AND SEL_MENU=2 THEN SEL_MENU=0:TO_MENU=0: SLEEP 666: GOTO 1000
2808 IF TO_MENU=1 THEN  GOTO 1000
2809 IF ETAP<3 THEN  GOTO 1000
2810 IF ( UP (0) AND YPERS%=-80) OR ( POINTX(0)>XGAM_UP AND  POINTX(0)<(XGAM_UP+HG) AND  POINTY(0)>(YGAM_UP-OKR) AND  POINTY(0)<(YGAM_UP+WG) AND YPERS%=-80) THEN  GOTO 2860
2820 IF ( DOWN (0) AND YPERS%=-80) OR ( POINTX(0)>XGAM_DOWN AND  POINTX(0)<(XGAM_DOWN+HG) AND  POINTY(0)>YGAM_DOWN AND  POINTY(0)<(YGAM_DOWN+WG+OKR) AND YPERS%=-80) THEN  GOTO 2900
2830 IF ( LEFT (0) AND YPERS%=-80) OR ( POINTX(0)>(XGAM_LEFT-OKR) AND  POINTX(0)<(XGAM_LEFT+WG) AND  POINTY(0)>YGAM_LEFT AND  POINTY(0)<(YGAM_LEFT+HG) AND YPERS%=-80) THEN  GOTO 2940
2840 IF ( RIGHT (0) AND YPERS%=-80) OR ( POINTX(0)>XGAM_RIGHT AND  POINTX(0)<(XGAM_RIGHT+WG+OKR) AND  POINTY(0)>YGAM_RIGHT AND  POINTY(0)<(YGAM_RIGHT+HG) AND YPERS%=-80) THEN  GOTO 2980
2841 IF (PRIGOK=0 AND YPERS%=-80 AND  FIRE (0)) OR ( POINTX(0)>=XFIRE_KEY AND  POINTX(0)<=XFIRE_KEY+WGF AND  POINTY(0)>=YFIRE_KEY AND  POINTY(0)<=YFIRE_KEY+WGF AND PRIGOK=0 AND YPERS%=-80) THEN  GOTO 3010
2842 IF UPING=1 AND PRIGOK=0 AND YPERS%=-80 THEN NAM_SON$="u-son"
2843 IF DOWNING=1 AND PRIGOK=0 AND YPERS%=-80 THEN NAM_SON$="d-son"
2844 IF LEFTING=1 AND PRIGOK=0 AND YPERS%=-80 THEN NAM_SON$="l-son"
2845 IF RIGHTING=1 AND PRIGOK=0 AND YPERS%=-80 THEN NAM_SON$="r-son"
2846 IF ( UP (0) AND YPERS%<>-80) OR ( POINTX(0)>XGAM_UP AND  POINTX(0)<(XGAM_UP+HG) AND  POINTY(0)>(YGAM_UP-OKR) AND  POINTY(0)<(YGAM_UP+WG) AND YPERS%<>-80) THEN HOD%=1: GOTO 3100
2847 IF ( DOWN (0) AND YPERS%<>-80) OR ( POINTX(0)>XGAM_DOWN AND  POINTX(0)<(XGAM_DOWN+HG) AND  POINTY(0)>YGAM_DOWN AND  POINTY(0)<(YGAM_DOWN+WG+OKR) AND YPERS%<>-80) THEN HOD%=1: GOTO 3200
2848 IF ( LEFT (0) AND YPERS%<>-80) OR ( POINTX(0)>(XGAM_LEFT-OKR) AND  POINTX(0)<(XGAM_LEFT+WG) AND  POINTY(0)>YGAM_LEFT AND  POINTY(0)<(YGAM_LEFT+HG) AND YPERS%<>-80) THEN HOD%=1: GOTO 3300
2849 IF ( RIGHT (0) AND YPERS%<>-80) OR ( POINTX(0)>XGAM_RIGHT AND  POINTX(0)<(XGAM_RIGHT+WG+OKR) AND  POINTY(0)>YGAM_RIGHT AND  POINTY(0)<(YGAM_RIGHT+HG) AND YPERS%<>-80) THEN HOD%=1: GOTO 3400
2850 IF UPING=1 AND YPERS%<>-80 THEN HOD%=0: GOTO 3100
2851 IF DOWNING=1 AND YPERS%<>-80 THEN HOD%=0: GOTO 3200
2852 IF LEFTING=1 AND YPERS%<>-80 THEN HOD%=0: GOTO 3300
2853 IF RIGHTING=1 AND YPERS%<>-80 THEN HOD%=0: GOTO 3400
2854 IF  POINTX(0)>=WSCREEN-LMX%-8 AND  POINTX(0)<WSCREEN AND  POINTY(0)<=LMX%+8 AND  POINTDRAGGED(0)=0 THEN  END 
2855 IF  POINTX(0)>=WSCREEN-72 AND  POINTY(0)>=HSCREEN-LMX%-8 AND PAUSE_GAME=0 AND  POINTDRAGGED(0)=0 THEN PAUSE_GAME=1
2856 IF  POINTX(0)>0 AND  POINTX(0)<=70 AND  POINTY(0)>=HSCREEN-LMX%-8 AND TO_MENU=0 AND  POINTDRAGGED(0)=0 THEN TO_MENU=1
2859 GOTO 1000
2860 FOR T%=0 TO N%-1
2870 ZDN(T%)=ZDN(T%)-5:ZDK(T%)=ZDK(T%)-5
2880 NEXT T%
2881 FOR T%=0 TO NC%-1
2882 ZDNC(T%)=ZDNC(T%)-5:ZDKC(T%)=ZDKC(T%)-5
2883 NEXT T%
2884 IF  MILLISECONDS (0)-SONIC%>5 THEN UP_S%=UP_S%+1:SONIC%= MILLISECONDS (0)
2885 IF UP_S%>14 THEN UP_S%=1
2886 NAM_SON$="son-up"+STR$(UP_S%)
2887 UPING=1:DOWNING=0:LEFTING=0:RIGHTING=0
2890 UR%=10:UG%=153:UB%=255
2891 Z_PN%=Z_PN%-5:Z_PK%=Z_PK%-5
2892 Z_FN%=Z_FN%-5:Z_FK%=Z_FK%-5
2893 Z_Q1N%=Z_Q1N%-5:Z_Q1K%=Z_Q1K%-5:Z_Q2N%=Z_Q2N%-5:Z_Q2K%=Z_Q2K%-5:Z_Q3N%=Z_Q3N%-5:Z_Q3K%=Z_Q3K%-5: GOTO 1000
2900 FOR T%=0 TO N%-1
2910 ZDN(T%)=ZDN(T%)+5:ZDK(T%)=ZDK(T%)+5
2920 NEXT T%
2921 FOR T%=0 TO NC%-1
2922 ZDNC(T%)=ZDNC(T%)+5:ZDKC(T%)=ZDKC(T%)+5
2923 NEXT T%
2924 IF  MILLISECONDS (0)-SONIC%>5 THEN DW_S%=DW_S%+1:SONIC%= MILLISECONDS (0)
2925 IF DW_S%>16 THEN DW_S%=1
2926 NAM_SON$="down-son"+STR$(DW_S%)
2927 UPING=0:DOWNING=1:LEFTING=0:RIGHTING=0
2930 DR%=10:DG%=153:DB%=255
2931 Z_PN%=Z_PN%+5:Z_PK%=Z_PK%+5
2932 Z_FN%=Z_FN%+5:Z_FK%=Z_FK%+5
2933 Z_Q1N%=Z_Q1N%+5:Z_Q1K%=Z_Q1K%+5:Z_Q2N%=Z_Q2N%+5:Z_Q2K%=Z_Q2K%+5:Z_Q3N%=Z_Q3N%+5:Z_Q3K%=Z_Q3K%+5: GOTO 1000
2940 FOR T%=0 TO N%-1
2950 XDN(T%)=XDN(T%)+5:XDK(T%)=XDK(T%)+5
2960 NEXT T%
2961 FOR T%=0 TO NC%-1
2962 XDNC(T%)=XDNC(T%)+5:XDKC(T%)=XDKC(T%)+5
2963 NEXT T%
2964 IF  MILLISECONDS (0)-SONIC%>5 THEN LF_S%=LF_S%+1:SONIC%= MILLISECONDS (0)
2965 IF LF_S%>14 THEN LF_S%=1
2966 NAM_SON$="R-son"+STR$(LF_S%)
2967 UPING=0:DOWNING=0:LEFTING=1:RIGHTING=0
2970 LR%=10:LG%=153:LB%=255
2971 X_PN%=X_PN%+5:X_PK%=X_PK%+5
2972 X_FN%=X_FN%+5:X_FK%=X_FK%+5
2973 X_Q1N%=X_Q1N%+5:X_Q1K%=X_Q1K%+5:X_Q2N%=X_Q2N%+5:X_Q2K%=X_Q2K%+5:X_Q3N%=X_Q3N%+5:X_Q3K%=X_Q3K%+5: GOTO 1000
2980 FOR T%=0 TO N%-1
2990 XDN(T%)=XDN(T%)-5:XDK(T%)=XDK(T%)-5
3000 NEXT T%
3001 FOR T%=0 TO NC%-1
3002 XDNC(T%)=XDNC(T%)-5:XDKC(T%)=XDKC(T%)-5
3003 NEXT T%
3004 IF  MILLISECONDS (0)-SONIC%>5 THEN RT_S%=RT_S%+1:SONIC%= MILLISECONDS (0)
3005 IF RT_S%>14 THEN RT_S%=1
3006 NAM_SON$="L-son"+STR$(RT_S%)
3007 UPING=0:DOWNING=0:LEFTING=0:RIGHTING=1
3008 RR%=10:RG%=153:RB%=255:X_PN%=X_PN%-5:X_PK%=X_PK%-5:X_FN%=X_FN%-5:X_FK%=X_FK%-5
3009 X_Q1N%=X_Q1N%-5:X_Q1K%=X_Q1K%-5:X_Q2N%=X_Q2N%-5:X_Q2K%=X_Q2K%-5:X_Q3N%=X_Q3N%-5:X_Q3K%=X_Q3K%-5: GOTO 1000
3010 PRIGOK=1
3011 FR%=10:FG%=153:FB%=255: GOTO 1000
3100 IF  MILLISECONDS (0)-SONIC%>5 THEN U_PRG%=U_PRG%+1:SONIC%= MILLISECONDS (0)
3101 IF U_PRG%>4 THEN U_PRG%=1
3102 NAM_SON$="prg-son"+STR$(U_PRG%): IF HOD%=1 THEN  GOTO 3104
3103 GOTO 1000
3104 FOR T%=0 TO N%-1
3105 ZDN(T%)=ZDN(T%)-5:ZDK(T%)=ZDK(T%)-5
3106 NEXT T%
3107 FOR T%=0 TO NC%-1
3108 ZDNC(T%)=ZDNC(T%)-5:ZDKC(T%)=ZDKC(T%)-5
3109 NEXT T%
3110 UPING=1:DOWNING=0:LEFTING=0:RIGHTING=0
3111 UR%=10:UG%=153:UB%=255
3112 Z_PN%=Z_PN%-5:Z_PK%=Z_PK%-5
3113 Z_FN%=Z_FN%-5:Z_FK%=Z_FK%-5
3114 Z_Q1N%=Z_Q1N%-5:Z_Q1K%=Z_Q1K%-5:Z_Q2N%=Z_Q2N%-5:Z_Q2K%=Z_Q2K%-5:Z_Q3N%=Z_Q3N%-5:Z_Q3K%=Z_Q3K%-5: GOTO 1000
3200 IF  MILLISECONDS (0)-SONIC%>5 THEN D_PRG%=D_PRG%-1:SONIC%= MILLISECONDS (0)
3201 IF D_PRG%<0 THEN D_PRG%=4
3202 NAM_SON$="prg-son"+STR$(D_PRG%): IF HOD%=1 THEN  GOTO 3204
3203 GOTO 1000
3204 FOR T%=0 TO N%-1
3205 ZDN(T%)=ZDN(T%)+5:ZDK(T%)=ZDK(T%)+5
3206 NEXT T%
3207 FOR T%=0 TO NC%-1
3208 ZDNC(T%)=ZDNC(T%)+5:ZDKC(T%)=ZDKC(T%)+5
3209 NEXT T%
3210 UPING=0:DOWNING=1:LEFTING=0:RIGHTING=0
3211 DR%=10:DG%=153:DB%=255
3212 Z_PN%=Z_PN%+5:Z_PK%=Z_PK%+5
3213 Z_FN%=Z_FN%+5:Z_FK%=Z_FK%+5
3214 Z_Q1N%=Z_Q1N%+5:Z_Q1K%=Z_Q1K%+5:Z_Q2N%=Z_Q2N%+5:Z_Q2K%=Z_Q2K%+5:Z_Q3N%=Z_Q3N%+5:Z_Q3K%=Z_Q3K%+5: GOTO 1000
3300 IF  MILLISECONDS (0)-SONIC%>5 THEN L_PRG%=L_PRG%+1:SONIC%= MILLISECONDS (0)
3301 IF L_PRG%>4 THEN L_PRG%=1
3302 NAM_SON$="L-prg-son"+STR$(L_PRG%): IF HOD%=1 THEN  GOTO 3304
3303 GOTO 1000
3304 FOR T%=0 TO N%-1
3305 XDN(T%)=XDN(T%)+5:XDK(T%)=XDK(T%)+5
3306 NEXT T%
3307 FOR T%=0 TO NC%-1
3308 XDNC(T%)=XDNC(T%)+5:XDKC(T%)=XDKC(T%)+5
3309 NEXT T%
3310 UPING=0:DOWNING=0:LEFTING=1:RIGHTING=0
3311 LR%=10:LG%=153:LB%=255
3312 X_PN%=X_PN%+5:X_PK%=X_PK%+5
3313 X_FN%=X_FN%+5:X_FK%=X_FK%+5
3314 X_Q1N%=X_Q1N%+5:X_Q1K%=X_Q1K%+5:X_Q2N%=X_Q2N%+5:X_Q2K%=X_Q2K%+5:X_Q3N%=X_Q3N%+5:X_Q3K%=X_Q3K%+5: GOTO 1000
3400 IF  MILLISECONDS (0)-SONIC%>5 THEN R_PRG%=R_PRG%+1:SONIC%= MILLISECONDS (0)
3401 IF R_PRG%>4 THEN R_PRG%=1
3402 NAM_SON$="R-prg-son"+STR$(R_PRG%): IF HOD%=1 THEN  GOTO 3404
3403 GOTO 1000
3404 FOR T%=0 TO N%-1
3405 XDN(T%)=XDN(T%)-5:XDK(T%)=XDK(T%)-5
3406 NEXT T%
3407 FOR T%=0 TO NC%-1
3408 XDNC(T%)=XDNC(T%)-5:XDKC(T%)=XDKC(T%)-5
3409 NEXT T%
3410 UPING=0:DOWNING=0:LEFTING=0:RIGHTING=1
3411 RR%=10:RG%=153:RB%=255
3412 X_PN%=X_PN%-5:X_PK%=X_PK%-5
3413 X_FN%=X_FN%-5:X_FK%=X_FK%-5
3414 X_Q1N%=X_Q1N%-5:X_Q1K%=X_Q1K%-5:X_Q2N%=X_Q2N%-5:X_Q2K%=X_Q2K%-5:X_Q3N%=X_Q3N%-5:X_Q3K%=X_Q3K%-5: GOTO 1000
